<html><body style="width: 100%; height: 100%; overflow: hidden">

<div><iframe style="width: 98%; height:30%" id="preview"></iframe></div>

<div><textarea style="width: 98%; height: 25%" id="tex">
\documentclass[11pt]{article}
\begin{document}
\title{My Article}
\author{Nobody Jr.}
\date{Today}
\maketitle
Blablabla said Nobody ~\cite{Nobody06}.
\bibliography{example}{}
\bibliographystyle{plain}
\end{document}
</textarea></div>
<div><textarea style="width: 98%; height: 15%" id="bib">
@misc{Nobody06,
   author = "Nobody Jr",
   title = "My Article",
   year = "2006" 
}
</textarea></div>

<div><textarea style="width: 98%; height: 20%" id="status"></textarea></div>
<div><button style="width: 98%; height: 5%; font-size: x-large" onclick="onclick_()">Compile</button></div> 

<script>


worker = new Worker('/worker.js');
worker.onmessage = e =>
{
    const {pdf, log} = e.data;
    if(pdf)
    {
        let previewElement = document.getElementById('preview');
        previewElement.src = URL.createObjectURL(new Blob([pdf], {type: 'application/pdf'}));
    }

    if(log)
    {
        let statusElement = document.getElementById('status');
        statusElement.value += log + '\n';
        statusElement.scrollTop = statusElement.scrollHeight;
    }
}

function onclick_()
{
    const tex = document.getElementById('tex').value, bib = document.getElementById('bib').value;
    worker.postMessage({tex : tex, bib :bib})
}

</script>


</body></html>
